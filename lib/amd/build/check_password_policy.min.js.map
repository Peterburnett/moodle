{"version":3,"sources":["../src/check_password_policy.js"],"names":["define","ajax","utils","init","username","elementname","document","querySelector","addEventListener","throttle","password","promises","call","methodname","args","value","then","data","lookupId","name","error","errmsg","style","display","innerHTML","fail"],"mappings":"AAsBAA,OAAM,8BAAC,CAAC,WAAD,CAAc,YAAd,CAAD,CAA8B,SAASC,CAAT,CAAeC,CAAf,CAAsB,CACtD,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAmBC,CAAnB,CAAgC,CAElCC,QAAQ,CAACC,aAAT,CAAuB,aAAeF,CAAtC,EAAmDG,gBAAnD,CAAoE,OAApE,CAA6EN,CAAK,CAACO,QAAN,CAAe,UAAW,IAE/FC,CAAAA,CAAQ,CAAG,IAFoF,CAI/FC,CAAQ,CAAGV,CAAI,CAACW,IAAL,CAAU,CAAC,CACtBC,UAAU,CAAE,4BADU,CAEtBC,IAAI,CAAE,CACFV,QAAQ,CAAEA,CADR,CAEFM,QAAQ,CAAE,KAAKK,KAFb,CAFgB,CAAD,CAAV,CAJoF,CAanGJ,CAAQ,CAAC,CAAD,CAAR,CAAYK,IAAZ,CAAiB,SAASC,CAAT,CAAe,IAExBC,CAAAA,CAAQ,CAAG,aAAeR,CAAQ,CAACS,IAFX,CAGxBC,CAAK,CAAGd,QAAQ,CAACC,aAAT,CAAuBW,CAAvB,CAHgB,CAK5B,GAAmB,EAAf,EAAAD,CAAI,CAACI,MAAT,CAAuB,CACnBD,CAAK,CAACE,KAAN,CAAYC,OAAZ,CAAsB,OAAtB,CACAH,CAAK,CAACI,SAAN,CAAkBP,CAAI,CAACI,MAC1B,CAHD,IAGO,CAEHD,CAAK,CAACE,KAAN,CAAYC,OAAZ,CAAsB,MAAtB,CACAH,CAAK,CAACI,SAAN,CAAkB,EACrB,CAGJ,CAfD,EAeGC,IAfH,EAgBH,CA7B4E,CA6B1E,GA7B0E,CAA7E,CA8BH,CAjCE,CAmCV,CApCK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module to display password policy validation live when changing password.\n *\n * @module     core/check_password_policy\n * @copyright  2020 Peter Burnett <peterburnett@catalyst-au.net>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['core/ajax', 'core/utils'], function(ajax, utils) {\n    return {\n        init: function(username, elementname) {\n            // Select only the first input element with matching name.\n            document.querySelector(\"input[id*=\" + elementname).addEventListener('keyup', utils.throttle(function() {\n                // Store element for later use.\n                var password = this;\n                // Make AJAX call to the webservice.\n                var promises = ajax.call([{\n                    methodname: 'core_check_password_policy',\n                    args: {\n                        username: username,\n                        password: this.value\n                    }\n                }]);\n\n                // Resolve the promise, and use the error div to display as if it was form validation.\n                promises[0].then(function(data) {\n                    // Select the generated error div for form element.\n                    var lookupId = '#id_error_' + password.name;\n                    var error = document.querySelector(lookupId);\n\n                    if (data.errmsg != '') {\n                        error.style.display = 'block';\n                        error.innerHTML = data.errmsg;\n                    } else {\n                        // If error message is clean hide the div.\n                        error.style.display = 'none';\n                        error.innerHTML = '';\n                    }\n\n                    return;\n                }).fail();\n            }, 100));\n        }\n    };\n});\n"],"file":"check_password_policy.min.js"}